{
    "name": "Audit Log",
    "module": "DigiComply",
    "doctype": "DocType",
    "custom": 0,
    "istable": 0,
    "issingle": 0,
    "is_tree": 0,
    "editable_grid": 0,
    "track_changes": 0,
    "engine": "InnoDB",
    "naming_rule": "Expression",
    "autoname": "AUDIT-.YYYY.-.######",
    "title_field": "event_type",
    "search_fields": "event_type,document_type,document_name,user",
    "sort_field": "creation",
    "sort_order": "DESC",
    "description": "Immutable audit log for compliance tracking - records cannot be modified or deleted",
    "fields": [
        {
            "fieldname": "event_section",
            "fieldtype": "Section Break",
            "label": "Event Details",
            "collapsible": 0
        },
        {
            "fieldname": "event_type",
            "fieldtype": "Select",
            "label": "Event Type",
            "reqd": 1,
            "in_list_view": 1,
            "in_standard_filter": 1,
            "options": "\nDocument Created\nDocument Modified\nDocument Deleted\nDocument Submitted\nDocument Cancelled\nDocument Amended\nBulk Import Executed\nReconciliation Run\nASP Sync Performed\nReport Generated\nReport Exported\nUser Login\nUser Logout\nPermission Changed\nSettings Changed\nData Exported\nData Purged\nArchive Retrieved\nAuditor Access Granted\nAuditor Access Revoked"
        },
        {
            "fieldname": "event_timestamp",
            "fieldtype": "Datetime",
            "label": "Event Timestamp",
            "reqd": 1,
            "in_list_view": 1,
            "default": "Now"
        },
        {
            "fieldname": "column_break_1",
            "fieldtype": "Column Break"
        },
        {
            "fieldname": "severity",
            "fieldtype": "Select",
            "label": "Severity",
            "options": "Info\nWarning\nCritical",
            "default": "Info",
            "in_standard_filter": 1
        },
        {
            "fieldname": "event_category",
            "fieldtype": "Select",
            "label": "Category",
            "options": "\nDocument\nUser\nSystem\nCompliance\nSecurity\nIntegration\nData",
            "in_standard_filter": 1
        },
        {
            "fieldname": "document_section",
            "fieldtype": "Section Break",
            "label": "Document Reference",
            "collapsible": 0
        },
        {
            "fieldname": "document_type",
            "fieldtype": "Link",
            "label": "Document Type",
            "options": "DocType",
            "in_list_view": 1,
            "in_standard_filter": 1
        },
        {
            "fieldname": "document_name",
            "fieldtype": "Dynamic Link",
            "label": "Document Name",
            "options": "document_type",
            "in_list_view": 1
        },
        {
            "fieldname": "column_break_2",
            "fieldtype": "Column Break"
        },
        {
            "fieldname": "snapshot_reference",
            "fieldtype": "Link",
            "label": "Before Snapshot",
            "options": "Document Snapshot",
            "description": "Point-in-time state before this event"
        },
        {
            "fieldname": "after_snapshot_reference",
            "fieldtype": "Link",
            "label": "After Snapshot",
            "options": "Document Snapshot",
            "description": "Point-in-time state after this event"
        },
        {
            "fieldname": "user_section",
            "fieldtype": "Section Break",
            "label": "User Information",
            "collapsible": 0
        },
        {
            "fieldname": "user",
            "fieldtype": "Link",
            "label": "User",
            "options": "User",
            "reqd": 1,
            "in_list_view": 1,
            "in_standard_filter": 1
        },
        {
            "fieldname": "user_full_name",
            "fieldtype": "Data",
            "label": "User Full Name",
            "read_only": 1
        },
        {
            "fieldname": "column_break_3",
            "fieldtype": "Column Break"
        },
        {
            "fieldname": "ip_address",
            "fieldtype": "Data",
            "label": "IP Address"
        },
        {
            "fieldname": "user_agent",
            "fieldtype": "Small Text",
            "label": "User Agent",
            "hidden": 1
        },
        {
            "fieldname": "session_id",
            "fieldtype": "Data",
            "label": "Session ID",
            "hidden": 1
        },
        {
            "fieldname": "company_section",
            "fieldtype": "Section Break",
            "label": "Company Context",
            "collapsible": 1
        },
        {
            "fieldname": "company",
            "fieldtype": "Link",
            "label": "Company",
            "options": "Company",
            "in_standard_filter": 1
        },
        {
            "fieldname": "trn",
            "fieldtype": "Data",
            "label": "TRN"
        },
        {
            "fieldname": "details_section",
            "fieldtype": "Section Break",
            "label": "Event Details",
            "collapsible": 0
        },
        {
            "fieldname": "description",
            "fieldtype": "Text",
            "label": "Description"
        },
        {
            "fieldname": "changes_summary",
            "fieldtype": "Text",
            "label": "Changes Summary",
            "description": "Summary of fields changed (for Document Modified events)"
        },
        {
            "fieldname": "column_break_4",
            "fieldtype": "Column Break"
        },
        {
            "fieldname": "affected_records_count",
            "fieldtype": "Int",
            "label": "Affected Records",
            "description": "Number of records affected (for bulk operations)"
        },
        {
            "fieldname": "operation_duration",
            "fieldtype": "Float",
            "label": "Duration (seconds)",
            "description": "Time taken for the operation"
        },
        {
            "fieldname": "raw_data_section",
            "fieldtype": "Section Break",
            "label": "Raw Data",
            "collapsible": 1
        },
        {
            "fieldname": "request_data",
            "fieldtype": "Code",
            "label": "Request Data",
            "options": "JSON",
            "description": "Raw request data (if applicable)"
        },
        {
            "fieldname": "response_data",
            "fieldtype": "Code",
            "label": "Response Data",
            "options": "JSON",
            "description": "Raw response data (if applicable)"
        },
        {
            "fieldname": "integrity_section",
            "fieldtype": "Section Break",
            "label": "Integrity Verification",
            "collapsible": 1
        },
        {
            "fieldname": "record_hash",
            "fieldtype": "Data",
            "label": "Record Hash",
            "read_only": 1,
            "description": "SHA-256 hash for tamper detection"
        },
        {
            "fieldname": "previous_hash",
            "fieldtype": "Data",
            "label": "Previous Record Hash",
            "read_only": 1,
            "description": "Hash of previous audit log entry (chain integrity)"
        },
        {
            "fieldname": "column_break_5",
            "fieldtype": "Column Break"
        },
        {
            "fieldname": "integrity_verified",
            "fieldtype": "Check",
            "label": "Integrity Verified",
            "read_only": 1,
            "default": "1"
        },
        {
            "fieldname": "verification_timestamp",
            "fieldtype": "Datetime",
            "label": "Last Verification",
            "read_only": 1
        }
    ],
    "permissions": [
        {
            "role": "System Manager",
            "read": 1,
            "write": 0,
            "create": 0,
            "delete": 0,
            "export": 1,
            "report": 1
        },
        {
            "role": "DigiComply Admin",
            "read": 1,
            "write": 0,
            "create": 0,
            "delete": 0,
            "export": 1,
            "report": 1
        },
        {
            "role": "External Auditor",
            "read": 1,
            "write": 0,
            "create": 0,
            "delete": 0,
            "export": 1,
            "report": 1
        }
    ],
    "links": [],
    "actions": [],
    "default_print_format": "",
    "show_preview_popup": 0,
    "make_attachments_public": 0
}
